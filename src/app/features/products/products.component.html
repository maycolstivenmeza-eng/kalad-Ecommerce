<!-- CONTENEDOR GENERAL -->
<section class="products-page">

  <!-- Breadcrumb (opcional) -->
  <nav class="breadcrumb">
    <a routerLink="/home">Inicio</a>
    <span>/</span>
    <span>Productos</span>
  </nav>

  <div class="layout">

    <!-- ======= SIDEBAR/FILTROS ======= -->
    <aside class="sidebar">

      <!-- Ordenar por (versiÃ³n de sidebar colapsable) -->
      <div class="filter-block">
        <button class="filter-title" type="button">
          Ordenar por
          <span class="caret">â–¾</span>
        </button>
        <div class="filter-content">
          <ul class="order-list">
            <li (click)="onOrderChange('az')" [class.active]="orden==='az'">A-Z</li>
            <li (click)="onOrderChange('za')" [class.active]="orden==='za'">Z-A</li>
            <li (click)="onOrderChange('priceAsc')" [class.active]="orden==='priceAsc'">Precio: bajo â†’ alto</li>
            <li (click)="onOrderChange('priceDesc')" [class.active]="orden==='priceDesc'">Precio: alto â†’ bajo</li>
            <li (click)="onOrderChange('new')" [class.active]="orden==='new'">Nuevos</li>
          </ul>
        </div>
      </div>

      <!-- Talla -->
      <div class="filter-block">
        <button class="filter-title" type="button">
          Talla
          <span class="caret">â–¾</span>
        </button>
        <div class="filter-content">
          <div class="chip-group">
            <button class="chip" 
                    *ngFor="let t of tallas" 
                    [class.active]="filtroTalla===t"
                    (click)="setFiltroTalla(t)">{{ t }}</button>
          </div>
        </div>
      </div>

      <!-- Color -->
      <div class="filter-block">
        <button class="filter-title" type="button">
          Color
          <span class="caret">â–¾</span>
        </button>
        <div class="filter-content">
          <div class="color-pills">
            <button class="color-pill" 
                    *ngFor="let c of colores"
                    [style.--color]="c.hex"
                    [class.active]="filtroColor===c.id"
                    (click)="setFiltroColor(c.id)"
                    [attr.aria-label]="c.label">
            </button>
          </div>
        </div>
      </div>

      <!-- CategorÃ­as -->
      <div class="filter-block">
        <div class="filter-title static">CategorÃ­as</div>
        <ul class="category-list">
          <li>
            <button class="link" [class.active]="filtroCategoria==='Bolsas'" (click)="setFiltroCategoria('Bolsas')">Bolsas</button>
          </li>
          <li>
            <button class="link" [class.active]="filtroCategoria==='Mochilas'" (click)="setFiltroCategoria('Mochilas')">Mochilas</button>
          </li>
          <li>
            <button class="link" [class.active]="filtroCategoria==='Morrales'" (click)="setFiltroCategoria('Morrales')">Morrales</button>
          </li>
          <li>
            <button class="link" [class.active]="filtroCategoria==='Zapatos'" (click)="setFiltroCategoria('Zapatos')">Zapatos</button>
          </li>
        </ul>
      </div>

    </aside>

    <!-- ======= CONTENIDO PRINCIPAL ======= -->
    <main class="content">

      <!-- Barra superior de orden global (derecha) -->
      <div class="topbar">
        <div class="order-inline">
          <span>Ordenar por:</span>
          <div class="order-inline-select">
            <button class="inline-option" [class.active]="orden==='az'" (click)="onOrderChange('az')">A-Z</button>
            <button class="inline-option" [class.active]="orden==='za'" (click)="onOrderChange('za')">Z-A</button>
            <button class="inline-option" [class.active]="orden==='priceAsc'" (click)="onOrderChange('priceAsc')">Precio â†‘</button>
            <button class="inline-option" [class.active]="orden==='priceDesc'" (click)="onOrderChange('priceDesc')">Precio â†“</button>
          </div>
        </div>
      </div>

      <!-- GRID DE PRODUCTOS -->
      <div class="product-grid">

        <!-- Card de producto -->
        <article class="product-card" *ngFor="let p of productosFiltrados" [attr.data-id]="p.id">
          <a class="thumb" [routerLink]="['/products', p.id]">
            <span class="badge" *ngIf="p.badge" [ngClass]="p.badge">
              {{ p.badge }}
            </span>
            <!-- Imagen principal -->
            <img class="img primary" [src]="p.imagen" [alt]="p.nombre" />
            <!-- Imagen secundaria (si existe) para hover -->
            <img
              class="img hover"
              *ngIf="p.imagenes && p.imagenes.length > 0"
              [src]="p.imagenes[0]"
              [alt]="p.nombre"
            />
          </a>

          <a class="title" [routerLink]="['/products', p.id]">
            {{ p.nombre }}
          </a>

          <div class="price-row">
            <span class="price">{{ p.precio | currency:'COP':'symbol-narrow':'1.0-0' }}</span>

            <button class="cart-btn" type="button" (click)="addToCart(p)">
              <span class="cart-icon" aria-hidden="true">ðŸ›’</span>
            </button>
          </div>
        </article>

        <!-- Sin resultados -->
        <div class="no-results" *ngIf="productosFiltrados?.length === 0">
          No se encontraron productos con los filtros seleccionados.
        </div>

      </div>

      <!-- (opcional) PaginaciÃ³n o â€œCargar mÃ¡sâ€ -->
      <!--
      <div class="load-more" *ngIf="puedeCargarMas">
        <button class="btn-more" (click)="cargarMas()">Cargar mÃ¡s</button>
      </div>
      -->

    </main>

  </div>
</section>
