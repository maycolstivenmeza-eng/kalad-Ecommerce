<section class="product-page" *ngIf="product as p">

  <!-- BREADCRUMB -->
  <nav class="breadcrumb">
    <a routerLink="/">Inicio</a> /
    <a routerLink="/products">Productos</a> /
    <span>{{ p.nombre }}</span>
  </nav>

  <!-- ===================== CONTENEDOR GENERAL ====================== -->
  <div class="product-container">

    <!-- ===== THUMBNAILS ===== -->
    <aside class="gallery">
      <div
        class="thumb"
        *ngFor="let img of thumbnailImages; let i = index"
        [class.active]="selectedImage === img"
        (click)="selectImage(img)"
      >
        <img [src]="img" />
      </div>
    </aside>

    <!-- ===== IMAGEN PRINCIPAL ===== -->
    <div class="main-image">
      <img [src]="selectedImage" />
    </div>

    <!-- ===== INFORMACIÓN ===== -->
    <div class="info">

      <div class="badge" *ngIf="p.badge" [ngClass]="p.badge">{{ p.badge }}</div>
      <h1 class="title">{{ p.nombre }}</h1>

      <p class="price">{{ formatPrice(p.precio) }}</p>

      <!-- COLOR -->
      <div class="color-section">
        <p class="subtitle">Color</p>

        <div class="colors">
          <div
            class="color-circle"
            *ngFor="let c of (p.colores || [])"
            [style.background]="c"
            [class.selected]="selectedColor === c"
            (click)="selectColor(c)"
          ></div>
        </div>
      </div>

      <!-- CANTIDAD -->
      <div class="qty-section">
        <p class="subtitle">Cantidad</p>

        <div class="qty-box">
          <button (click)="decrement()">−</button>

          <input
            type="number"
            [(ngModel)]="quantity"
            min="1"
            [max]="p.stock || 99"
          />

          <button (click)="increment()">+</button>
        </div>
      </div>

      <!-- BOTONES -->
      <button class="btn-buy" (click)="buyNow()">Comprar Ahora</button>

      <button class="btn-cart" (click)="addToCart()">Agregar al Carrito</button>

      <button class="favorite-btn">♡ Añadir a favoritos</button>

    </div>
  </div>

  <!-- ===================== DESCRIPCIÓN ====================== -->
  <section class="description">
    <h2>Descripción</h2>
    <p>
      {{ p.descripcion }}
    </p>
  </section>

  <!-- ===================== CARACTERÍSTICAS ====================== -->
  <section class="features">
    <h2>Características</h2>

    <p>
      La {{ p.nombre }} está elaborada con materiales artesanales locales de alta calidad.
      Cada pieza es trabajada a mano por artesanas colombianas, brindando un diseño elegante,
      fresco y duradero ideal para tus actividades diarias.
    </p>
  </section>

  <!-- ===================== DIMENSIONES ====================== -->
  <section class="dimensions">
    <h2>Dimensiones</h2>

    <table>
      <tr>
        <td>Alto</td>
        <td class="value">{{ displayDimensions?.alto }}</td>
      </tr>
      <tr>
        <td>Ancho</td>
        <td class="value">{{ displayDimensions?.ancho }}</td>
      </tr>
      <tr>
        <td>Profundidad</td>
        <td class="value">{{ displayDimensions?.profundidad }}</td>
      </tr>
      <tr>
        <td>Capacidad</td>
        <td class="value">{{ displayDimensions?.capacidad }}</td>
      </tr>
    </table>
  </section>

  <!-- ===================== OPINIONES ====================== -->
  <section class="reviews">
    <h2>Opiniones de los Clientes</h2>

    <div class="review" *ngFor="let r of reviews">
      <p class="review-name">{{ r.name }}</p>
      <p class="review-date">{{ r.date }}</p>

      <div class="stars">
        <span *ngFor="let s of stars; let i = index">
          {{ i < r.rating ? '★' : '☆' }}
        </span>
      </div>

      <p class="review-comment">{{ r.comment }}</p>
    </div>
  </section>
